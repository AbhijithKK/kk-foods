<nav class="navbar navbar-expand-lg  bg-light fixed-top"
  style=" background: linear-gradient(to bottom right, #ff3300 3%, #ffccff 100%);">
  <div class="container">
    <button class="navbar-toggler " type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span></button>
    <a class="navbar-brand" href="#" style="font-family:cursive;">kk foods</a>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">

      <ul class="navbar-nav mr-auto mt-2 mt-lg-0 mx-auto">
        <li class="nav-item active ">
          <a class="nav-link " href="/admin/home">Dash bord</a>
        </li>
        <li class="nav-item active">
          <a class="nav-link" href="/admin/productDetails" style="font-weight: bold;">Product details</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/admin/orderDetails">Order details</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/admin/userDetails">User Details</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/admin/catogaryManage">Category Manage</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/admin/coupen">Coupen Manage</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/admin/offerCreate">Offer Manage</a>
        </li>
      </ul>

      <a href="/admin/logout" class="btn btn btn-outline-primary ms-auto">log out</a>
    </div>
  </div>
</nav>


<section style="margin-top: 4rem;">
  <div class="container">
    <div class="row">
     
      <div style="margin-top: 19px;
margin-bottom: 19px;">
        <a href="/admin/addProduct" class="btn btn-primary my-2 my-sm-0">Add product</a>

      </div>

    </div>

    <table  id="myTable" class="display" style="margin-top: 30px;">
      <thead>
        <tr>
          <th scope="col">No</th>
          <th scope="col">image</th>
          <th scope="col">product name</th>
          <th scope="col">catogary</th>
          <th scope="col">description</th>
          <th scope="col">price</th>
         
          <th scope="col">action</th>
        </tr>
      </thead>
      <tbody>
        {{#each product}}

        <tr>

          <td>{{inc @index}}</td>
          {{!-- {{/with}} --}}
          <td><img src="/images/{{this.image1.[0].filename}}" alt="" style="width: 40px;height: 50px;"></td>
          <td>{{this.productName}}</td>
          <td>{{this.productCatogary}}</td>
          <td>{{this.productDiscription}}</td>
          <td>{{this.productPrize}}</td>
          
          <td>
            <a href="/admin/editproduct/{{this._id}}" class="btn btn-primary btn-block mb-4">edit</a>
            <a id="{{this._id}}" type="button" class="btn btn-danger btn-block mb-4"
              onclick="message('{{this._id}}','{{this.del}}')"  >
              {{this.del}}
              </a>
              <input id="temp" type="text" value="{{this.del}}" hidden>
          </td>
        </tr>

        {{/each}}

      </tbody>
    </table>

  </div>
</section>
<!-- Modal -->
<div class="modal fade" id="staticBackdrop"  data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" 
style="display: none;
opacity: 2.0;
background: rgba(0, 0, 0, 0.5);
margin-top: rem;">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="width: 20rem;">
      <div class="modal-body">
        <h1 class="modal-title fs-5" id="staticBackdropLabel"></h1>      
      </div>     
  </div>
</div>

<script>
  

  $(document).ready( function () {
    $('#myTable').DataTable();
} );
function message(id,del){
 let tempr= document.getElementById('temp')
  let m=''
    if(tempr.value=="unflage"){
      m='flage'
    }else{
      m='unflage'
    }  
  console.log(del,tempr.value)
  tempr.value=m
  fetch(`http://localhost:3000/admin/productDelete?id=${id}&delet=${m}`,{
    method:"get",
    headers:{
      "Content-Type":"application/json"
    },

  }).then((data)=>data.json()).then((data)=>{
    console.log(data)
    document.getElementById(id).innerHTML=m
    document.getElementById('staticBackdropLabel').innerHTML=`Product ${m}ed `
    document.getElementById('staticBackdrop').style.display='block'
    setTimeout(function() {
      document.getElementById('staticBackdrop').style.display = "none";
    }, 900); 
  })
  
    return false
}
  
</script>
